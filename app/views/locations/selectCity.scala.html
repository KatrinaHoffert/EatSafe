@import general._
@import models._
@import controllers._
@import play.api.libs.json.Json

@**
 * Allows a user to select their city of interest from a list of municipalities in their
 * current region.
 *
 * @param municipalities A list of all the municipalities the user may choose from.
 *@
@(municipalities: Seq[String])

@scripts = {
  <script src="@controllers.routes.Assets.at("javascripts/common.js")"></script>
  <script>
    "use strict";
    
    var cities = @Html(Json.toJson(municipalities).toString)
    
    $("#municipality").typeahead({
      delay: 100,
      minLength: 1,
      maxItem: 8,
      hint: true,
      source: {
        data: cities
      },
      callback: {
        onSubmit: function(node, form, obj, e) {
          if(obj == null) {
            createPageError("I'm sorry, Dave, that not valid input.");
            return;
          }

          window.location.assign("/find/" + obj.display);
        }
      }
    });
    $("#municipality").focus();
  </script>
}

@mainBody(title = Messages("locations.selectCity.title"), moreScripts = scripts) {
  @headingLarge(Messages("general.applicationName"))
  <div class="smallPadding">
    <h2>@Messages("locations.selectCity.prompt")</h2>

    <form id="form-municipality">
      <div class="typeahead-container">
        <div class="typeahead-field">
          <span class="typeahead-query">
            <input id="municipality" type="search" placeholder="Search" autocomplete="off">
          </span>
          <span class="typeahead-button">
            <button type="submit" id="submitButton">
              <i class="search-icon"></i>
            </button>
          </span>
        </div>
      </div>
    </form>
  </div>
}
